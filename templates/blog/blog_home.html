{% extends 'base.html' %}
{% load static %}
{# Django HTML Template - CSS validation disabled for template syntax #}

{% block page_title %}
Blog
{% endblock %}

{% block content %}
<main>
      <!-- Header start -->
      <section class="mt-8" data-cue="fadeIn">
         <div class="container">
            <a href="#!">
               <div class="py-lg-10 rounded-3 px-lg-8 py-md-8 px-md-6 p-4 image-blur"
                  style="background-image: url('{% static "assets/images/landings/agency/agency-hero-img.jpg" %}'); background-position: center; background-repeat: no-repeat; background-size: cover;">
                  <div class="row g-0">
                     <div class="col-xxl-6 col-xl-7 col-lg-8">
                        <div class="d-flex flex-column gap-10" data-cue="zoomIn">
                           <div>
                              <span
                                 class="badge border border-white text-white-stable px-3 py-2 fw-medium rounded-pill fs-6">Blog</span>
                           </div>
                           <div class="d-flex flex-column gap-6">
                              <div class="d-flex flex-column gap-3">
                                 <h1 class="mb-0 text-white-stable">The Code Feed & Fresh Finds
                                 </h1>
                                 <p class="mb-0 text-white-stable">
                                    Serving up the freshest programming ingredients from across the web. Where APIs are the main course, Python is the secret sauce, and every tutorial is a recipe for digital success. Warning: may contain traces of caffeine and existential debugging sessions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </a>
         </div>
      </section>
      <!-- Header end -->

      <!-- Blog Posts START -->
      <section class="mb-xl-9 mb-5 my-8" data-cue="fadeIn">
         <div class="container">
            <div class="row gy-5 gy-lg-0">

               <div class="col-xxl-9 col-lg-8 col-12">
                  <div class="row g-5">
                     {% for post in posts %}

                     <div class="col-xxl-6 col-12" data-cue="fadeIn">
                        <a href="{% url 'blog_post' post.slug %}">
                           <div class="rounded-3 p-4 image-blur" style="
                                    background: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0) 10%, rgba(0, 0, 0, 0.8) 100%), url({% static 'assets/images/blog/blog-img-3.jpg' %});
                                    background-position: center;
                                    background-repeat: no-repeat;
                                    background-size: cover;
                                 ">
                              <div class="d-flex flex-column gap-10" data-cue="zoomOut">
                                 {% for category in post.categories.all %}
                                 <div>
                                    <span
                                       class="badge border rounded-pill border-white text-white-stable px-3 py-2 fw-medium fs-6">{{category}}</span>
                                 </div>
                                 {% endfor %}

                                 <div class="d-flex flex-column gap-4">
                                    <div class="d-flex flex-column gap-1">
                                       <h3 class="mb-0 text-white-stable text-truncate">{{ post.title }}</h3>
                                       <p class="mb-0 text-white-stable text-truncate">
                                          {{ post.excerpt|truncatechars:50 }}
                                       </p>
                                    </div>
                                    <div class="d-flex align-items-center align-items-center gap-3">
                                       <div class="d-flex flex-row align-items-center gap-2">
                                          <div class="mb-0 text-white-stable fs-6">{{ post.author }}</div>
                                       </div>
                                       <span class="text-white-stable fs-6">{{ post.published_at|date:"d.m.Y" }}</span>
                                    </div>
                                 </div>
                              </div>
                           </div>
                        </a>
                     </div>
                     {% endfor %}

                  </div>
               </div>

               <!-- Blog Posts ENDS -->


               <!-- Newsletter -->
               <div class="col-xxl-3 col-lg-4 col-12">
                  <div class="d-flex flex-column gap-5" data-cue="fadeIn">
                     <div class="bg-success bg-opacity-10 rounded-3 p-md-5 p-4" data-cue="zoomOut">
                        <div class="d-flex flex-column gap-4">
                           <div>
                              <span class="bg-success-subtle text-success-emphasis rounded-circle icon-shape icon-xl">
                                 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                                    class="bi bi-envelope" viewBox="0 0 16 16">
                                    <path
                                       d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z" />
                                 </svg>
                              </span>
                           </div>
                           <div class="d-flex flex-column gap-2">
                              <h3 class="mb-0 text-success-emphasis h4">Subscribe Newsletter</h3>
                              <p class="mb-0 text-dark">Register now to get latest updates about the topics you
                                 interest.</p>
                           </div>
                           <form class="needs-validation" method="post" novalidate>
                              {% csrf_token %}
                              
                              <!-- Display form errors -->
                              {% if form.errors %}
                                 <div class="alert alert-danger mb-3">
                                    {% for field, errors in form.errors.items %}
                                       {% for error in errors %}
                                          <div>{{ error }}</div>
                                       {% endfor %}
                                    {% endfor %}
                                 </div>
                              {% endif %}

                              <div class="mb-3">
                                 <label for="id_email" class="form-label visually-hidden">Email</label>
                                 <input type="email" 
                                        class="form-control border-0" 
                                        id="id_email" 
                                        name="email"
                                        placeholder="email@example.com" 
                                        value="{{ form.email.value|default:'' }}"
                                        required />
                                 {% if form.email.errors %}
                                    <div class="invalid-feedback d-block">
                                       {% for error in form.email.errors %}{{ error }}{% endfor %}
                                    </div>
                                 {% endif %}
                              </div>

                              <!-- Agreement checkbox -->
                              <div class="mb-3 form-check">
                                 <input type="checkbox" 
                                        class="form-check-input" 
                                        id="id_agreement" 
                                        name="agreement"
                                        {% if form.agreement.value %}checked{% endif %}
                                        required />
                                 <label class="form-check-label small" for="id_agreement">
                                    I agree to receive newsletter updates
                                 </label>
                                 {% if form.agreement.errors %}
                                    <div class="invalid-feedback d-block">
                                       {% for error in form.agreement.errors %}{{ error }}{% endfor %}
                                    </div>
                                 {% endif %}
                              </div>

                              <div class="d-grid">
                                 <button class="btn btn-success" type="submit">Sign Up</button>
                              </div>
                           </form>
                        </div>
                     </div>
                  </div>
               </div>
               <!-- Newsletter ENDS-->

            </div>
         </div>
      </section>
      <!-- Event start -->
      <section class="my-xl-9 my-5" data-cue="fadeIn">
         <div class="container">
            <div class="">
               <div class="row">
                  <div class="col-12" data-cue="fadeIn">
                     <ul class="nav nav-pills mb-6 nav-primary" id="pills-tab" role="tablist">
                        <!-- All Posts tab -->
                        <li class="nav-item" role="presentation">
                           <button class="nav-link me-2 active" 
                                   type="button" 
                                   data-category="all"
                                   onclick="filterPosts('all')">
                              All Posts
                           </button>
                        </li>
                        <!-- Category tabs -->
                        {% for category in all_categories %}
                        <li class="nav-item" role="presentation">
                           <button class="nav-link me-2" 
                                   type="button" 
                                   data-category="{{ category.slug }}"
                                   onclick="filterPosts('{{ category.slug }}')">
                              {{ category.name }}
                           </button>
                        </li>
                        {% endfor %}
                     </ul>
                     
                     <!-- Posts Content -->
                     <div class="mb-6">
                        <!-- Bootstrap Carousel -->
                        <div id="postsCarousel" class="carousel slide" data-bs-ride="carousel">
                           <div class="carousel-inner">
                              <!-- First slide (posts 1-3 on large screens, 1-2 on smaller screens) -->
                              <div class="carousel-item active">
                                 <div class="row g-4">
                                    {% for post in posts|slice:":3" %}
                                    <div class="col-lg-4 col-md-6 col-12 post-item{% if forloop.counter > 2 %} d-none d-lg-block{% endif %}" 
                                         data-categories="{% for category in post.categories.all %}{{ category.slug }}{% if not forloop.last %},{% endif %}{% endfor %}"
                                         data-cue="zoomIn">
                                       <div class="card h-100">
                                          <div class="card-body d-flex flex-column gap-3">
                                             <!-- Post Image -->
                                             <img src="{% static 'assets/images/blog/blog-img-1.jpg' %}" 
                                                  alt="{{ post.title }}" 
                                                  class="rounded img-fluid w-100" />
                                             
                                             <!-- Post Content -->
                                             <div class="d-flex flex-column gap-3 flex-grow-1">
                                                <!-- Categories -->
                                                <div class="d-flex flex-wrap gap-1">
                                                   {% for category in post.categories.all %}
                                                   <span class="badge bg-primary-subtle text-primary-emphasis">{{ category.name }}</span>
                                                   {% endfor %}
                                                </div>
                                                
                                                <!-- Title and Excerpt -->
                                                <div class="d-flex flex-column gap-2">
                                                   <h3 class="mb-0 h6">
                                                      <a href="{% url 'blog_post' post.slug %}" class="text-reset text-decoration-none">
                                                         {{ post.title }}
                                                      </a>
                                                   </h3>
                                                   <p class="mb-0 text-muted small">
                                                      {{ post.excerpt|truncatechars:80 }}
                                                   </p>
                                                </div>
                                                
                                                <!-- Meta Info -->
                                                <div class="mt-auto d-flex align-items-center justify-content-between">
                                                   <div class="d-flex align-items-center gap-2">
                                                      <img src="{% static 'assets/images/avatar/avatar-3.jpg' %}" 
                                                           alt="{{ post.author }}" 
                                                           class="avatar avatar-xs rounded-circle" />
                                                      <div class="fs-7 text-muted">{{ post.author }}</div>
                                                   </div>
                                                   <span class="fs-7 text-muted">{{ post.published_at|date:"M d" }}</span>
                                                </div>
                                             </div>
                                          </div>
                                       </div>
                                    </div>
                                    {% endfor %}
                                 </div>
                              </div>
                              
                              <!-- Second slide (posts 4-6 on large screens, posts 3-4 on smaller screens) -->
                              {% if posts|length > 3 %}
                              <div class="carousel-item">
                                 <div class="row g-4">
                                    {% for post in posts|slice:"3:6" %}
                                    <div class="col-lg-4 col-md-6 col-12 post-item{% if forloop.counter > 2 %} d-none d-lg-block{% endif %}" 
                                         data-categories="{% for category in post.categories.all %}{{ category.slug }}{% if not forloop.last %},{% endif %}{% endfor %}"
                                         data-cue="zoomIn">
                                       <div class="card h-100">
                                          <div class="card-body d-flex flex-column gap-3">
                                             <!-- Post Image -->
                                             <img src="{% static 'assets/images/blog/blog-img-1.jpg' %}" 
                                                  alt="{{ post.title }}" 
                                                  class="rounded img-fluid w-100" />
                                             
                                             <!-- Post Content -->
                                             <div class="d-flex flex-column gap-3 flex-grow-1">
                                                <!-- Categories -->
                                                <div class="d-flex flex-wrap gap-1">
                                                   {% for category in post.categories.all %}
                                                   <span class="badge bg-primary-subtle text-primary-emphasis">{{ category.name }}</span>
                                                   {% endfor %}
                                                </div>
                                                
                                                <!-- Title and Excerpt -->
                                                <div class="d-flex flex-column gap-2">
                                                   <h3 class="mb-0 h6">
                                                      <a href="{% url 'blog_post' post.slug %}" class="text-reset text-decoration-none">
                                                         {{ post.title }}
                                                      </a>
                                                   </h3>
                                                   <p class="mb-0 text-muted small">
                                                      {{ post.excerpt|truncatechars:80 }}
                                                   </p>
                                                </div>
                                                
                                                <!-- Meta Info -->
                                                <div class="mt-auto d-flex align-items-center justify-content-between">
                                                   <div class="d-flex align-items-center gap-2">
                                                      <img src="{% static 'assets/images/avatar/avatar-3.jpg' %}" 
                                                           alt="{{ post.author }}" 
                                                           class="avatar avatar-xs rounded-circle" />
                                                      <div class="fs-7 text-muted">{{ post.author }}</div>
                                                   </div>
                                                   <span class="fs-7 text-muted">{{ post.published_at|date:"M d" }}</span>
                                                </div>
                                             </div>
                                          </div>
                                       </div>
                                    </div>
                                    {% endfor %}
                                 </div>
                              </div>
                              {% endif %}
                              
                              <!-- Third slide (posts 5-6 for medium screens only) -->
                              {% if posts|length > 4 %}
                              <div class="carousel-item d-lg-none">
                                 <div class="row g-4">
                                    {% for post in posts|slice:"4:6" %}
                                    <div class="col-md-6 col-12 post-item" 
                                         data-categories="{% for category in post.categories.all %}{{ category.slug }}{% if not forloop.last %},{% endif %}{% endfor %}"
                                         data-cue="zoomIn">
                                       <div class="card h-100">
                                          <div class="card-body d-flex flex-column gap-3">
                                             <!-- Post Image -->
                                             <img src="{% static 'assets/images/blog/blog-img-1.jpg' %}" 
                                                  alt="{{ post.title }}" 
                                                  class="rounded img-fluid w-100" />
                                             
                                             <!-- Post Content -->
                                             <div class="d-flex flex-column gap-3 flex-grow-1">
                                                <!-- Categories -->
                                                <div class="d-flex flex-wrap gap-1">
                                                   {% for category in post.categories.all %}
                                                   <span class="badge bg-primary-subtle text-primary-emphasis">{{ category.name }}</span>
                                                   {% endfor %}
                                                </div>
                                                
                                                <!-- Title and Excerpt -->
                                                <div class="d-flex flex-column gap-2">
                                                   <h3 class="mb-0 h6">
                                                      <a href="{% url 'blog_post' post.slug %}" class="text-reset text-decoration-none">
                                                         {{ post.title }}
                                                      </a>
                                                   </h3>
                                                   <p class="mb-0 text-muted small">
                                                      {{ post.excerpt|truncatechars:80 }}
                                                   </p>
                                                </div>
                                                
                                                <!-- Meta Info -->
                                                <div class="mt-auto d-flex align-items-center justify-content-between">
                                                   <div class="d-flex align-items-center gap-2">
                                                      <img src="{% static 'assets/images/avatar/avatar-3.jpg' %}" 
                                                           alt="{{ post.author }}" 
                                                           class="avatar avatar-xs rounded-circle" />
                                                      <div class="fs-7 text-muted">{{ post.author }}</div>
                                                   </div>
                                                   <span class="fs-7 text-muted">{{ post.published_at|date:"M d" }}</span>
                                                </div>
                                             </div>
                                          </div>
                                       </div>
                                    </div>
                                    {% endfor %}
                                 </div>
                              </div>
                              {% endif %}
                           </div>
                           
                           <!-- Carousel indicators (hidden for cleaner look) -->
                           <div class="carousel-indicators d-none">
                              <button type="button" data-bs-target="#postsCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                              {% if posts|length > 3 %}
                              <button type="button" data-bs-target="#postsCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
                              {% endif %}
                           </div>
                        </div>
                        
                        <!-- No posts message -->
                        <div class="text-center py-5 d-none" id="no-posts-message">
                           <div class="mb-4">
                              <i class="bi bi-journal-x text-muted" style="font-size: 3rem;"></i>
                           </div>
                           <h4 class="text-muted">No posts found</h4>
                           <p class="text-muted">No posts are available in this category.</p>
                        </div>
                     </div>
                     <div class="d-flex align-items-center justify-content-center">
                        <a href="#!" class="btn btn-light">See All Post</a>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </section>
      <!-- Event end -->

   </main>
{% endblock %}